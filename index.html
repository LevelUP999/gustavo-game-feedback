<!DOCTYPE html>
<html lang="pt-BR">

<head>
  <meta charset="UTF-8">
  <title>SenacTEC | Jogo de AdivinhaÃ§Ã£o ðŸ˜‚</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <style>
    button.rounded-md.transition[type=submit]:hover {
      transform: translateY(3px);
    }

    @keyframes bounce-animation {
      0%, 100%{transform: translateY(0);}
      50%{transform: translateY(15px);}
    }
  </style>
</head>

<body class="bg-gray-900 text-white flex items-center justify-center min-h-screen">
  <p class="absolute top-10 opacity-30 animate-pulse" style="animation: bounce-animation 2s infinite ease-in-out;">Â© All Copyrights for Gustavo Rodrigues Cunha</p>
  <div class="text-center space-y-6">
    <h1 class="text-3xl font-bold">Jogo de AdivinhaÃ§Ã£o</h1>
    <p class="text-teal-600 opacity-50">â€” Made by: <strong>Gustavo Rodrigues Cunha â€”</strong></p>

    <div id="board" class="space-y-2"></div>

    <form id="guess-form" class="flex justify-center space-x-2">
      <input id="guess-input" maxlength="5" minlength="5" required
        class="text-black px-4 py-2 rounded-md focus:outline-none uppercase tracking-widest text-center font-mono"
        placeholder="Digite 5 letras" />
      <button type="submit" class="bg-blue-500 hover:bg-blue-600 px-4 py-2 rounded-md">Tentar</button>
    </form>

    <p id="message" class="text-lg font-semibold"></p>

    <!-- FormulÃ¡rio de feedback (escondido inicialmente) -->
    <form id="feedback"
      class="hidden flex flex-col items-center gap-6 p-6 bg-white/10 rounded-xl shadow-lg w-full max-w-md">
      <h3 class="text-lg font-semibold text-white">
        O que vocÃª achou do <strong class="text-violet-400">jogo</strong>?
      </h3>

      <section class="flex gap-6">
        <label for="form1" class="cursor-pointer">
          <input type="radio" name="emoji" id="form1" class="hidden peer">
          <div
            class="text-4xl peer-checked:ring-4 peer-checked:ring-violet-400 peer-checked:ring-offset-2 peer-checked:ring-offset-black rounded-lg transition">
            ðŸ˜‚</div>
        </label>

        <label for="form2" class="cursor-pointer">
          <input type="radio" name="emoji" id="form2" class="hidden peer">
          <div
            class="text-4xl peer-checked:ring-4 peer-checked:ring-yellow-400 peer-checked:ring-offset-2 peer-checked:ring-offset-black rounded-lg transition">
            ðŸ˜‘</div>
        </label>

        <label for="form3" class="cursor-pointer">
          <input type="radio" name="emoji" id="form3" class="hidden peer">
          <div
            class="text-4xl peer-checked:ring-4 peer-checked:ring-red-400 peer-checked:ring-offset-2 peer-checked:ring-offset-black rounded-lg transition">
            ðŸ˜¡</div>
        </label>
      </section>

      <!-- Nome -->
      <section class="w-full">
        <label for="user-name" class="text-white">Nome (opcional):</label>
        <input type="text" id="user-name" placeholder="Ana banana..."
          class="w-full mt-1 px-4 py-2 rounded-md bg-white/80 text-black placeholder-gray-500 focus:outline-none focus:ring-2 focus:ring-violet-500 transition" />
      </section>

      <!-- ComentÃ¡rio -->
      <section class="w-full">
        <label for="user-coment" class="text-white">ComentÃ¡rio (opcional):</label>
        <input type="text" id="user-coment" placeholder="Seu comentÃ¡rio..."
          class="w-full mt-1 px-4 py-2 rounded-md bg-white/80 text-black placeholder-gray-500 focus:outline-none focus:ring-2 focus:ring-violet-500 transition" />
      </section>

      <button type="submit"
        class="bg-violet-500 hover:bg-indigo-600 text-white px-6 py-2 rounded-md transition duration-200 shadow-md">Enviar</button>
    </form>
  </div>

  <script>
    const palavras = [
      "abuso", "aceno", "Ã¡guao", "aluno", "amigo", "anexo", "andar", "antes", "apito", "arroz",
      "astro", "balÃ£o", "baile", "banho", "barco", "beijo", "berro", "bravo", "breve", "burro",
      "caixa", "canal", "canto", "cegas", "chave", "clima", "clube", "colhe", "cores", "crime",
      "danÃ§a", "dedos", "deseo", "dores", "ecoar", "elite", "engar", "escol", "exato", "falar",
      "farpa", "fases", "feito", "feliz", "feroz", "final", "forno", "fotos", "freio", "fruta",
      "ganho", "girar", "golpe", "grito", "grupo", "honra", "humor", "Ã­cone", "idade", "idioma",
      "igual", "impor", "inato", "Ã­ntimo", "irmÃ£o", "itens", "janta", "jogar", "junto", "laÃ§os",
      "lento", "lÃ­der", "linda", "limpo", "linha", "livre", "luzes", "macio", "magia", "mecha",
      "misto", "moeda", "mundo", "natal", "nÃ­vel", "nobre", "notas", "nuvem", "olhos", "ondas",
      "Ã´nibus", "ouvir", "pagar", "papel", "parte", "peito", "perda", "ponto", "preÃ§o", "prova"
    ];

    const palavraSecreta = palavras[Math.floor(Math.random() * palavras.length)];
    const maxTentativas = 7;
    let tentativas = 0;

    const form = document.getElementById("guess-form");
    const input = document.getElementById("guess-input");
    const board = document.getElementById("board");
    const message = document.getElementById("message");

    const feedbackForm = document.getElementById("feedback");
    const emojiInputs = document.querySelectorAll("input[name='emoji']");
    const nameInput = document.getElementById("user-name");
    const commentInput = document.getElementById("user-coment");

    form.addEventListener("submit", (e) => {
      e.preventDefault();
      const tentativa = input.value.toLowerCase();

      if (tentativa.length !== 5) {
        message.textContent = "A palavra deve ter 5 letras.";
        return;
      }

      mostrarTentativa(tentativa);
      tentativas++;

      if (tentativa === palavraSecreta) {
        message.textContent = "ParabÃ©ns! VocÃª acertou!";
        form.remove();
        feedbackForm.classList.remove("hidden");
      } else if (tentativas >= maxTentativas) {
        message.textContent = `VocÃª perdeu! A palavra era "${palavraSecreta.toUpperCase()}".`;
        form.remove();
      } else {
        message.textContent = "";
      }

      input.value = "";
    });

    function mostrarTentativa(palavra) {
      const linha = document.createElement("div");
      linha.className = "flex justify-center space-x-1";

      const letrasContadas = {};
      for (let letra of palavraSecreta) {
        letrasContadas[letra] = (letrasContadas[letra] || 0) + 1;
      }

      const resultado = Array(5).fill("gray");

      for (let i = 0; i < 5; i++) {
        if (palavra[i] === palavraSecreta[i]) {
          resultado[i] = "green";
          letrasContadas[palavra[i]]--;
        }
      }

      for (let i = 0; i < 5; i++) {
        if (resultado[i] === "gray" && letrasContadas[palavra[i]] > 0) {
          resultado[i] = "yellow";
          letrasContadas[palavra[i]]--;
        }
      }

      for (let i = 0; i < 5; i++) {
        const span = document.createElement("span");
        span.textContent = palavra[i].toUpperCase();
        span.className = "w-12 h-12 flex items-center justify-center rounded font-bold text-xl uppercase";

        if (resultado[i] === "green") {
          span.classList.add("bg-green-500", "text-white");
        } else if (resultado[i] === "yellow") {
          span.classList.add("bg-yellow-400", "text-black");
        } else {
          span.classList.add("bg-gray-600", "text-white");
        }

        linha.appendChild(span);
      }

      board.appendChild(linha);
    }

    // Enviar feedback para Supabase
    feedbackForm.addEventListener("submit", async (e) => {
      e.preventDefault();

      const selectedEmoji = [...emojiInputs].find(input => input.checked)?.id;

      if (!selectedEmoji) {
        alert("Por favor, selecione um emoji.");
        return;
      }

      const emojiMap = {
        form1: "ðŸ˜‚",
        form2: "ðŸ˜‘",
        form3: "ðŸ˜¡"
      };

      const emoji = emojiMap[selectedEmoji];
      const name = nameInput.value.trim() || "anÃ´nimo";
      const comment = commentInput.value.trim() || "anÃ´nimo";

      const payload = {
        name,
        emoji,
        Coment: comment // importante: Coment com C maiÃºsculo
      };

      try {
        const response = await fetch("https://ukqwrpyabtkbttibholb.supabase.co/rest/v1/gustavo-Game", {
          method: "POST",
          headers: {
            "Content-Type": "application/json",
            "apikey": "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InVrcXdycHlhYnRrYnR0aWJob2xiIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTE2NTcxMDEsImV4cCI6MjA2NzIzMzEwMX0.buH-SooEcnodDHREFkAsJcVLyv6rqbHiJ92d6tfaJ4I",
            "Authorization": "Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InVrcXdycHlhYnRrYnR0aWJob2xiIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTE2NTcxMDEsImV4cCI6MjA2NzIzMzEwMX0.buH-SooEcnodDHREFkAsJcVLyv6rqbHiJ92d6tfaJ4I",
            "Prefer": "return=minimal"
          },
          body: JSON.stringify(payload)
        });


        if (response.ok) {
          alert("Obrigado pelo feedback!");
          feedbackForm.reset();
          feedbackForm.classList.add("hidden");
        } else {
          alert("Erro ao enviar feedback.");
        }
      } catch (error) {
        console.error("Erro:", error);
        alert("Erro na conexÃ£o com o servidor.");
      }
    });
  </script>
</body>

</html>
